{% extends "base.html" %}

{% block content %}
<div class="container" style="min-height: 80vh; display: flex; flex-direction: column; justify-content: center; align-items: center;">

    <h1 class="text-center mb-3">Data Cleaning Tool</h1>
    <p class="text-center text-muted mb-5">
        Quickly clean your Excel or CSV files and prepare them for visualization.
    </p>

    <!-- UPLOAD CARD -->
    <div class="card shadow-lg p-5" style="max-width: 700px; width: 100%;">

        <h2 class="text-center mb-3">Upload Your Excel / CSV File</h2>
        <p class="text-center text-muted mb-1">
            Upload your file and let the tool automatically clean and prepare your data for visualization.
        </p>

        {% if error %}
            <div class="alert alert-danger">{{ error }}</div>
        {% endif %}

        <form id="uploadForm" method="post" enctype="multipart/form-data">
            {% csrf_token %}

            <div class="mb-3">
                <input
                    type="file"
                    name="file"
                    class="form-control form-control-lg"
                    id="fileInput"
                    accept=".csv,.xls,.xlsx"
                    required
                >
            </div>

            <button
                type="submit"
                class="btn btn-primary btn-lg w-100 py-3 mt-3"
                id="uploadBtn"
            >
                Upload & Clean
            </button>
        </form>

        <!-- Loading Spinner -->
        <div id="loadingSpinner" class="text-center mt-4" style="display: none;">
            <div class="spinner-border text-primary" role="status" style="width: 3rem; height: 3rem;">
                <span class="visually-hidden">Uploading...</span>
            </div>
            <p class="mt-3 text-muted">Uploading and processing your fileâ€¦</p>
        </div>

    </div>
</div>

<script>
const form = document.getElementById("uploadForm");
const spinner = document.getElementById("loadingSpinner");
const uploadBtn = document.getElementById("uploadBtn");

form.addEventListener("submit", function () {
    // Prevent double submissions
    uploadBtn.disabled = true;
    uploadBtn.textContent = "Uploading...";

    // Show spinner
    spinner.style.display = "block";
});
</script>

{% endblock %}
